version: "3.9"

services:
web:
build: .
command: sh -c "python manage.py migrate && gunicorn movies_api.wsgi:application --bind 0.0.0.0:8000"
volumes:
- .:/app
ports:
- "8000:8000"
env_file:
- .env
depends_on:
- db

db:
image: postgres:15
restart: always
environment:
POSTGRES_DB: movies_db
POSTGRES_USER: movies_user
POSTGRES_PASSWORD: movies_pass
volumes:
- postgres_data:/var/lib/postgresql/data

volumes:
postgres_data:
